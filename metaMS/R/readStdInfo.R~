readStdInfo <- function(stdInfo, InputDir, validation = "NIST",
                        filetype = "cdf") {
  ## ##################################################################
  ## Read stdInfo file
  ## ##################################################################
  info <- read.table(stdInfo, sep = ";", header = TRUE,
                     dec = ",", as.is = TRUE)
  info[, "RTman"] <- as.numeric(info[,"RTman"])
  info[, "monoMW"] <- as.numeric(info[,"monoMW"])

  if (!is.null(validation))    ## restrict to only admissable values
      info <- info[info[,"validated"] %in% validation,]
  ## remove columns that only contain NA values
  NAcols <- which(apply(info, 2, function(x) all(is.na(x))))
  if (length(NAcols) > 0) info <- info[, -NAcols]

  ## ##################################################################
  ## compare and check input files. Case sensitive!
  ## ##################################################################
  extensions <- file_ext(info[, "stdFile"])
  if (max(nchar(extensions)) == 0)
      extensions <- filetype

  fnames <- list_files_with_exts(InputDir, exts = extensions,
                                 full.names = FALSE)
  fpaths <- list_files_with_exts(InputDir, exts = extensions,
                                 full.names = TRUE)
  fn <- file_path_sans_ext(fnames)

  ## ## Code from before Sept 26, 2013: only looking for cdf files...
  ## fnames <- list.files(path = InputDir, ignore.case = TRUE, 
  ##                      pattern = "*.cdf", full.names = FALSE)
  ## fpaths <- list.files(path = InputDir, ignore.case = TRUE, 
  ##                      pattern = "*.cdf", full.names = TRUE)
  ## remove file extension
  ## fn <- sapply(1:length(fnames),
  ##              function(x)
  ##              substr(fnames[x], 1, nchar(fnames[x])-4))
  
  ## check 1: are all input files present that are needed? (if not: error)
  presenceCheck <- info[,"stdFile"] %in% fn
  if (!all(presenceCheck))
      stop("Not all required data files present in ", InputDir, ":\n",
           paste(info[!presenceCheck, "stdFile"], collapse = "\n\t"))
  
  ## check 2: are all data files that are present actually used?
  ## (if not: warning)
  presenceCheck <- fn %in% info[,"stdFile"]
  if (!all(presenceCheck))
      warning("The following data files in ", InputDir, " are not used:\n\t",
              paste(fn[!presenceCheck], collapse = "\n\t"))
  
  ## replace file names in table with complete filename
  info[,"stdFile"] <- fpaths[match(info[,"stdFile"], fn)]
  
  info
}
