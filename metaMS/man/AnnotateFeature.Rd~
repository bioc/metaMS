\name{AnnotateFeature}
\alias{AnnotateFeature}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{
AnnotateFeature
%%  ~~function to do ... ~~
}
\description{
%%  ~~ A concise (1-5 lines) description of what the function does. ~~
Function to annotate a vector of the form (mz,rt,I) by using a specific
database and a specific error function to calculate the mass tolerance.
}
\usage{
AnnotateFeature(input, DB, mzwindow = 0.05, rttol = 0.5)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{input}{
   A vector with three elements in the form \code{(mz,rt,I)}.
}
  \item{DB}{
a dataframe used for tha annotation
}
  \item{mzwindow}{
The tolerance (dalton) used for m/z matching if the error surface is not defined.
}
  \item{rttol}{
Retention time tolerance in minuts
}
}
\details{
If a variable named \code{errf} is present in the workspace, it is used to calculate the mass tolerance as a function of the mass range and of the logarithm of the intensity of the signal. \code{errf} is used inside a \code{predict(errf, data.frame(M = input[1], logI = log10(input[3])))} call.

The DB is a \code{data.frame} which should contain the following fields: \code{"mz.observed"}, \code{"rt.1"} and \code{"mz.err"} %%  ~~ I
}
\value{
A vector of indices which associate the feature to the entries in the database 
}
\references{
%% ~put references to the literature/web site here ~
}
\author{
Pietro Franceschi
}
\note{
%%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
%% ~~objects to See Also as \code{\link{help}}, ~~~
}
\examples{
##---- Should be DIRECTLY executable !! ----
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
\keyword{~annotate}
